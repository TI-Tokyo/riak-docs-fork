---
title: "Re: Deleting data / content from a key - will it trigger compaction?"
description: ""
project: community
lastmod: 2013-09-13T06:45:41-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg12258"
mailinglist_parent_id: "msg12257"
author_name: "Timo Gatsonides"
project_section: "mailinglistitem"
sent_date: 2013-09-13T06:45:41-07:00
---



Thanks for the clarification Matthew. One thing remaining and I understand 
there is no clear cut, 100% answer to this one. Your remark regarding old 
values of a key only getting purged if they happen to participate in the same 
compaction, can you please elaborate on that and specifically what the chances 
are that this occurs. Given that I'm adding around 100.000 objects per month 
and I'm now trying to remove those that are a year old - so there have been 
around 1M insertions after that, what are the odds that they'll participate in 
the same compaction? And if the odds are small, would it be better (higher 
chance of getting purged) to delete the key altogether?

Thanks,
Timo

> Here are some rough concepts of leveldb:
> 
> - Compaction in leveldb is triggered by input activity, not by key age or key 
> delete. 
> - A key delete does not actually delete a key, it creates a "tombstone".
> - Old values of a key only get purged if two versions of the key happen to 
> participate in the same compaction. Then the oldest is dropped.
> 
> Therefore, it is not easy to estimate the length of time before all your 1 to 
> 3Mb objects purge. They will purge and free up disk space eventually â€¦ but 
> not necessarily quickly. There is currently no means for a user to initiate 
> targeted compactions to address your situation. You will just have to wait.
> 
> Matthew
> 


\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

