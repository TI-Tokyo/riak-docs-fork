<!DOCTYPE html>
<html lang="en">
<head>
<title>Re: Fwd: Errors when using basho_bench</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="contents" href="index.html#00532" id="c">
<link rel="index" href="maillist.html#00532" id="i">
<link rel="prev" href="msg00531.html" id="p">
<link rel="next" href="msg00539.html" id="n">
<link rel="canonical" href="https://www.mail-archive.com/riak-users@lists.basho.com/msg00532.html">
<link rel="stylesheet" href="/normalize.css" media="screen">
<link rel="stylesheet" href="/master.css" media="screen">

<!--[if lt IE 9]>
<link rel="stylesheet" href="/ie.css" media="screen">
<![endif]-->
</head>
<body>
<script language="javascript" type="text/javascript">
document.onkeydown = NavigateThrough;
function NavigateThrough (event)
{
  if (!document.getElementById) return;
  if (window.event) event = window.event;
  if (event.target.tagName == 'INPUT') return;
  if (event.ctrlKey || event.metaKey) return;
  var link = null;
  switch (event.keyCode ? event.keyCode : event.which ? event.which : null) {
    case 74:
    case 80:
      link = document.getElementById ('p');
      break;
    case 75:
    case 78:
      link = document.getElementById ('n');
      break;
    case 69:
      link = document.getElementById ('e');
      break;
    }
  if (link && link.href) document.location = link.href;
}
</script>
<div itemscope itemtype="http://schema.org/Article" class="container">
<div class="skipLink">
<a href="#nav">Skip to site navigation (Press enter)</a>
</div>
<div class="content" role="main">
<div class="msgHead">
<h1>
<span class="subject"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Fwd%5C%3A+Errors+when+using+basho_bench%22&amp;o=newest" rel="nofollow"><span itemprop="name">Re: Fwd: Errors when using basho_bench</span></a></span>
</h1>
<p class="darkgray font13">
<span class="sender pipe"><a href="/search?l=riak-users@lists.basho.com&amp;q=from:%22Dan+Reverri%22" rel="nofollow"><span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">Dan Reverri</span></span></a></span>
<span class="date"><a href="/search?l=riak-users@lists.basho.com&amp;q=date:20100608" rel="nofollow">Tue, 08 Jun 2010 10:23:18 -0700</a></span>
</p>
</div>
<div itemprop="articleBody" class="msgBody">
<!--X-Body-of-Message-->
<pre>Hi Germain,

I've confirmed that the basho bench drivers for riakclient and riakc_pb do
not provide a content-type when submitting key/value pairs to Riak. This
should not cause problems while running the benchmark.</pre><pre>

Which driver were you using when you noticed the webmachine errors? Were you
making GET requests for keys created in the benchmark against the REST API
after the benchmark?

Thanks,
Dan

On Tue, Jun 8, 2010 at 9:29 AM, Dan Reverri &lt;d...@basho.com&gt; wrote:

&gt; Hi Germain,
&gt;
&gt; You should be able to work around this issue by specifying a full list of
&gt; default bucket properties with your change incorporated. For example, try
&gt; putting the following in your app.config:
&gt; {default_bucket_props, [{n_val,2},
&gt;                                  {allow_mult,false},
&gt;                                  {last_write_wins,false},
&gt;                                  {precommit, []},
&gt;                                  {postcommit, []},
&gt;                                  {chash_keyfun, {riak_core_util,
&gt; chash_std_keyfun}}]}
&gt;
&gt;
&gt; This is the full list of default bucket properties that can be found in
&gt; &quot;apps/riak_core/ebin/riak_core.app&quot; with the n_val changed to &quot;2&quot;.
&gt;
&gt;
&gt;
&gt;
&gt; On Tue, Jun 8, 2010 at 9:05 AM, Germain Maurice &lt;
&gt; germain.maur...@linkfluence.net&gt; wrote:
&gt;
&gt;&gt;  You're right, i put this line in the app.config :
&gt;&gt; ,{default_bucket_props, [{n_val, 2}]}
&gt;&gt;
&gt;&gt; Maybe, i made a mistake...
&gt;&gt;
&gt;&gt; Le 08/06/10 17:55, Dan Reverri a écrit :
&gt;&gt;
&gt;&gt; Forwarding my reply to the mailing list.
&gt;&gt;
&gt;&gt; ---------- Forwarded message ----------
&gt;&gt; From: Dan Reverri &lt;d...@basho.com&gt;
&gt;&gt; Date: Tue, Jun 8, 2010 at 8:45 AM
&gt;&gt; Subject: Re: Errors when using basho_bench
&gt;&gt; To: Germain Maurice &lt;germain.maur...@linkfluence.net&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; Hi Germain,
&gt;&gt;
&gt;&gt;  The first error &quot;{'function not
&gt;&gt; exported',[{riak_core_bucket,defaults,[]},&quot; would occur when a bucket does
&gt;&gt; not have a &quot;chash_keyfun&quot; property defined. This could occur if you have
&gt;&gt; specified default bucket properties in your app.config. There is a known
&gt;&gt; issue where bucket properties defined in the app.config file are not merged
&gt;&gt; with the hard coded defaults:
&gt;&gt; <a  rel="nofollow" href="http://issues.basho.com/show_bug.cgi?id=123">http://issues.basho.com/show_bug.cgi?id=123</a>
&gt;&gt;
&gt;&gt;  I'm not sure why this issue would only occur when increasing the
&gt;&gt; partition size. Were other changes made to app.config?
&gt;&gt;
&gt;&gt;
&gt;&gt;  The second error &quot;{case_clause,{error,timeout}}, 
&gt;&gt; [{riak_kv_wm_raw,content_types_provided,2}&quot;
&gt;&gt; occurs when a key/value pair has been inserted into Riak without a
&gt;&gt; content-type and retrieved via the REST interface. This can happen when
&gt;&gt; inserting key/value pairs with the native Erlang client or the protobuffs
&gt;&gt; client. These clients don't require that a content-type be set. I assume the
&gt;&gt; values in question were inserted by the basho bench utility so I will look
&gt;&gt; into how those values are inserted by basho bench.
&gt;&gt;
&gt;&gt;  Thanks,
&gt;&gt; Dan
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; On Tue, Jun 8, 2010 at 7:38 AM, Germain Maurice &lt;
&gt;&gt; germain.maur...@linkfluence.net&gt; wrote:
&gt;&gt;
&gt;&gt;&gt; After viewing the demonstration of basho_bench during the webinar of the
&gt;&gt;&gt; last week, we led some tests.
&gt;&gt;&gt; Here are some errors we are meeting while doing a benchmark with
&gt;&gt;&gt; basho_bench.
&gt;&gt;&gt;
&gt;&gt;&gt; Big notice : when the ring partition size was 64, i never got this kind
&gt;&gt;&gt; of error (excepting a crash of a node, due to not enough memory i think,
&gt;&gt;&gt; 1,5GB RAM). But now, i have 128 partitions (see my other message on the riak
&gt;&gt;&gt; ML about the ring partition size) and these errors occurs.
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; This error occured multiple times :
&gt;&gt;&gt;
&gt;&gt;&gt; =ERROR REPORT==== 8-Jun-2010::16:21:06 ===
&gt;&gt;&gt; ** State machine &lt;0.937.0&gt; terminating
&gt;&gt;&gt; ** Last event in was timeout
&gt;&gt;&gt; ** When State == initialize
&gt;&gt;&gt; **      Data  ==
&gt;&gt;&gt; {state,&lt;0.932.0&gt;,undefined,2,undefined,undefined,undefined,
&gt;&gt;&gt;                     8594018,undefined,undefined,undefined,undefined,
&gt;&gt;&gt;                     undefined,undefined,60000,undefined,
&gt;&gt;&gt;                     {&lt;&lt;&quot;test&quot;&gt;&gt;,&lt;&lt;&quot;25500&quot;&gt;&gt;},
&gt;&gt;&gt;                     {chstate,'r...@10.0.0.40',
&gt;&gt;&gt;                         [{'r...@10.0.0.40',{64,63443225844}}],
&gt;&gt;&gt;                         {128,
&gt;&gt;&gt;                          [{0,'r...@10.0.0.40'},
&gt;&gt;&gt;
&gt;&gt;&gt; {11417981541647679048466287755595961091061972992,
&gt;&gt;&gt;                            'r...@10.0.0.41'},
&gt;&gt;&gt;
&gt;&gt;&gt; {22835963083295358096932575511191922182123945984,
&gt;&gt;&gt;                            'r...@10.0.0.40'},
&gt;&gt;&gt;
&gt;&gt;&gt; {34253944624943037145398863266787883273185918976,
&gt;&gt;&gt;                            'r...@10.0.0.41'},
&gt;&gt;&gt;
&gt;&gt;&gt; {45671926166590716193865151022383844364247891968,
&gt;&gt;&gt;                            'r...@10.0.0.40'},
&gt;&gt;&gt;
&gt;&gt;&gt; {57089907708238395242331438777979805455309864960,
&gt;&gt;&gt;                            'r...@10.0.0.41'},
&gt;&gt;&gt; [...]
&gt;&gt;&gt;
&gt;&gt;&gt; {1415829711164312202009819681693899175291684651008,
&gt;&gt;&gt;                            'r...@10.0.0.40'},
&gt;&gt;&gt;
&gt;&gt;&gt; {1427247692705959881058285969449495136382746624000,
&gt;&gt;&gt;                            'r...@10.0.0.41'},
&gt;&gt;&gt;
&gt;&gt;&gt; {1438665674247607560106752257205091097473808596992,
&gt;&gt;&gt;                            'r...@10.0.0.40'},
&gt;&gt;&gt;
&gt;&gt;&gt; {1450083655789255239155218544960687058564870569984,
&gt;&gt;&gt;                            'r...@10.0.0.41'}]},
&gt;&gt;&gt;                         {dict,0,16,16,8,80,48,
&gt;&gt;&gt;
&gt;&gt;&gt; {[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]},
&gt;&gt;&gt;
&gt;&gt;&gt; {{[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],
&gt;&gt;&gt;                               []}}}},
&gt;&gt;&gt;                     undefined}
&gt;&gt;&gt; ** Reason for termination =
&gt;&gt;&gt; ** {'function not exported',[{riak_core_bucket,defaults,[]},
&gt;&gt;&gt;                             {riak_core_util,chash_key,1},
&gt;&gt;&gt;                             {riak_kv_get_fsm,initialize,2},
&gt;&gt;&gt;                             {gen_fsm,handle_msg,7},
&gt;&gt;&gt;                             {proc_lib,init_p_do_apply,3}]}
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; After shutting down the benchmark we also got this following error,
&gt;&gt;&gt; multiple times too :
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; =ERROR REPORT==== 8-Jun-2010::16:19:28 ===
&gt;&gt;&gt; webmachine error: path=&quot;/riak/test/16028&quot;
&gt;&gt;&gt; [{webmachine_decision_core,'-decision/1-lc$^1/1-1-',
&gt;&gt;&gt;     [{error,
&gt;&gt;&gt;          {error,
&gt;&gt;&gt;              {case_clause,{error,timeout}},
&gt;&gt;&gt;              [{riak_kv_wm_raw,content_types_provided,2},
&gt;&gt;&gt;               {webmachine_resource,resource_call,3},
&gt;&gt;&gt;               {webmachine_resource,do,3},
&gt;&gt;&gt;               {webmachine_decision_core,resource_call,1},
&gt;&gt;&gt;               {webmachine_decision_core,decision,1},
&gt;&gt;&gt;               {webmachine_decision_core,handle_request,2},
&gt;&gt;&gt;               {webmachine_mochiweb,loop,1},
&gt;&gt;&gt;               {mochiweb_http,headers,5}]}}]},
&gt;&gt;&gt;  {webmachine_decision_core,decision,1},
&gt;&gt;&gt;  {webmachine_decision_core,handle_request,2},
&gt;&gt;&gt;  {webmachine_mochiweb,loop,1},
&gt;&gt;&gt;  {mochiweb_http,headers,5},
&gt;&gt;&gt;  {proc_lib,init_p_do_apply,3}]
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; Any idea about these errors ?
&gt;&gt;&gt; No problem with Webmachine ?
&gt;&gt;&gt;
&gt;&gt;&gt; --
&gt;&gt;&gt; Germain Maurice
&gt;&gt;&gt; Administrateur Système/Réseau
&gt;&gt;&gt; Tel : +33.(0)1.42.43.54.33
&gt;&gt;&gt;
&gt;&gt;&gt; <a  rel="nofollow" href="http://www.linkfluence.net">http://www.linkfluence.net</a>
&gt;&gt;&gt;
&gt;&gt;&gt;
&gt;&gt;&gt; _______________________________________________
&gt;&gt;&gt; riak-users mailing list
&gt;&gt;&gt; riak-users@lists.basho.com
&gt;&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt;
&gt;&gt; --
&gt;&gt; Germain Maurice
&gt;&gt; Administrateur Système/Réseau
&gt;&gt; Tel : +33.(0)1.42.43.54.33
&gt;&gt; <a  rel="nofollow" href="http://www.linkfluence.net">http://www.linkfluence.net</a>
&gt;&gt;
&gt;&gt;
&gt;&gt; _______________________________________________
&gt;&gt; riak-users mailing list
&gt;&gt; riak-users@lists.basho.com
&gt;&gt; <a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
&gt;&gt;
&gt;&gt;
&gt;
</pre><pre>_______________________________________________
riak-users mailing list
riak-users@lists.basho.com
<a  rel="nofollow" href="http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com">http://lists.basho.com/mailman/listinfo/riak-users_lists.basho.com</a>
</pre>

</div>
<div class="msgButtons margintopdouble">
<ul class="overflow">
<li class="msgButtonItems"><a class="button buttonleft " accesskey="p" href="msg00531.html">Previous message</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="c" href="index.html#00532">View by thread</a></li>
<li class="msgButtonItems textaligncenter"><a class="button" accesskey="i" href="maillist.html#00532">View by date</a></li>
<li class="msgButtonItems textalignright"><a class="button buttonright " accesskey="n" href="msg00539.html">Next message</a></li>
</ul>
</div>
<a name="tslice"></a>
<div class="tSliceList margintopdouble">
<ul class="icons monospace">
<li class="icons-email"><span class="subject"><a href="msg00526.html">Errors when using basho_bench</a></span> <span class="sender italic">Germain Maurice</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00528.html">Fwd: Errors when using basho_bench</a></span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00529.html">Re: Fwd: Errors when using basho_bench</a></span> <span class="sender italic">Germain Maurice</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00531.html">Re: Fwd: Errors when using basho_bench</a></span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email tSliceCur"><span class="subject">Re: Fwd: Errors when using basho_bench</span> <span class="sender italic">Dan Reverri</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00539.html">Re: Fwd: Errors when using basho_ben...</a></span> <span class="sender italic">Germain Maurice</span></li>
<li><ul>
<li class="icons-email"><span class="subject"><a href="msg00547.html">Re: Fwd: Errors when using basho...</a></span> <span class="sender italic">Dan Reverri</span></li>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</ul>
</div>
<div class="overflow msgActions margintopdouble">
<div class="msgReply" >
<h2>
					Reply via email to
</h2>
<form method="POST" action="/mailto.php">
<input type="hidden" name="subject" value="Re: Fwd: Errors when using basho_bench">
<input type="hidden" name="msgid" value="AANLkTikoGk5kEKFJ2c8NpyHnbCFmElfiNAuh38Cc8LN6@mail.gmail.com">
<input type="hidden" name="relpath" value="riak-users@lists.basho.com/msg00532.html">
<input type="submit" value=" Dan Reverri ">
</form>
</div>
</div>
</div>
<div class="aside" role="complementary">
<div class="logo">
<a href="/"><img src="/logo.png" width=247 height=88 alt="The Mail Archive"></a>
</div>
<form class="overflow" action="/search" method="get">
<input type="hidden" name="l" value="riak-users@lists.basho.com">
<label class="hidden" for="q">Search the site</label>
<input class="submittext" type="text" id="q" name="q" placeholder="Search riak-users">
<input class="submitbutton" name="submit" type="image" src="/submit.png" alt="Submit">
</form>
<div class="nav margintop" id="nav" role="navigation">
<ul class="icons font16">
<li class="icons-home"><a href="/">The Mail Archive home</a></li>
<li class="icons-list"><a href="/riak-users@lists.basho.com/">riak-users - all messages</a></li>
<li class="icons-about"><a href="/riak-users@lists.basho.com/info.html">riak-users - about the list</a></li>
<li class="icons-expand"><a href="/search?l=riak-users@lists.basho.com&amp;q=subject:%22Re%5C%3A+Fwd%5C%3A+Errors+when+using+basho_bench%22&amp;o=newest&amp;f=1" title="e" id="e">Expand</a></li>
<li class="icons-prev"><a href="msg00531.html" title="p">Previous message</a></li>
<li class="icons-next"><a href="msg00539.html" title="n">Next message</a></li>
</ul>
</div>
<div class="listlogo margintopdouble">

</div>
<div class="margintopdouble">

</div>
</div>
</div>
<div class="footer" role="contentinfo">
<ul>
<li><a href="/">The Mail Archive home</a></li>
<li><a href="/faq.html#newlist">Add your mailing list</a></li>
<li><a href="/faq.html">FAQ</a></li>
<li><a href="/faq.html#support">Support</a></li>
<li><a href="/faq.html#privacy">Privacy</a></li>
<li class="darkgray">AANLkTikoGk5kEKFJ2c8NpyHnbCFmElfiNAuh38Cc8LN6@mail.gmail.com</li>
</ul>
</div>
</body>
</html>
