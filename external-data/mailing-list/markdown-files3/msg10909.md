---
title: "Re: Simple mapreduce with 2i returns different result"
description: ""
project: community
lastmod: 2013-04-17T00:56:02-07:00
sitemap:
  priority: 0.2
layout: mailinglistitem
mailinglist_id: "msg10909"
mailinglist_parent_id: "msg10903"
author_name: "Mattias SjÃ¶linder"
project_section: "mailinglistitem"
sent_date: 2013-04-17T00:56:02-07:00
---


Thanks for your help. Your query returned the same number over and over
again just as expected.

I think I have found the reason for my problem though. The client lib
CorrugatedIron seems to wrap each document in the MapReduce result into a
array turning the result into a nested array looking like:
[[{doc1}], [{doc2}], [{doc3}]] counting 3 arrays & 3 docs
and sometimes
[[{doc1}], [{doc2}, {doc3}]] counting 2 arrays and 2 docs (according to my
client code... :)

Why the result for same query in CorrugatedIron and for a simple curl
differs I don't know but I will investigate it further.


Thanks again for your help!

Best regards,
Mattias



2013/4/16 Christian Dahlqvist 

> Hi Mattias,
>
> The following curl query simply counts the number of inputs, and has
> worked well for me in the past. Can you please run it against the cluster a
> couple of times and see if it also return varying number of results?
>
> curl -XPOST http://localhost:8098/mapred
> -H 'Content-Type: application/json'
> -d '{"inputs":{
> "bucket":"som-bucket",
> "index":"userid\_bin",
> "key":"18481123123"
> },
> "query":[{"reduce":{"language":"erlang",
> "module":"riak\_kv\_mapreduce",
> "function":"reduce\_count\_inputs"
> }}]}'
>
> Best regards,
>
> Christian
>
>
>
>
>
> On 16 Apr 2013, at 15:52, Mattias SjÃ¶linder  wrote:
>
> 18481123123
>
>
>
\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_\_
riak-users mailing list
riak-users@lists.basho.com
http://lists.basho.com/mailman/listinfo/riak-users\_lists.basho.com

